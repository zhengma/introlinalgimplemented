# 《线性代数入门》配套程序设计练习：示范代码 v1.0

## 马正
### *渊学通教育广州校区*

---

## 介绍
**《线性代数入门》(Introduction to Linear Algebra)** 是全世界几乎每一所大学的所有数学、统计、计算机、物理、工程类专业都要在本科一年级开设的专业必修课，其开设的广泛程度可能仅次于《微积分》（“高等数学”）。但这两门课有两个最鲜明的差别：

1. 《微积分》课上教的绝大部分解题流程，自编程序来执行需要相当高级的计算机理论知识（“符号运算”）和编程能力；而《线性代数入门》讲到的大多数算法，如果不太追求运行效率的话，只需少量的编程知识和经验就能做到。其实，后者中的很多知识点，如矩阵乘法、高斯消元法、QR分解等等，天然就适合用一种“描述算法”的口吻，甚至“伪代码”来讲授。
2. 对于理工科的大一基础课，从高年级学习、读研深造乃至工作中的用途来看，《微积分》更多起到“数学语言”——描述问题的载体的作用，而并不总是要把积分积出来或者把微分方程的解析解写下来，所以相对更强调抽象的理解和推导；而《线性代数入门》的内容，很多时候就是要用它把大规模的问题算出来并诠释计算结果，所以更强调计算能力。事实上，在工业和科研中，很多时候把用微积分描述的问题算出来，靠的正是线性代数的知识，例如微分方程的有限元求解。

升华一些地说，计算数学、计算物理中的一大块内容，包括当下前沿的研究方向，都可以归结为“超大规模线性代数问题的高效率计算”。FORTRAN作为最早的一门高级语言，到今天还有一定的生命力，一个比较重要的原因就是LINPACK，一个高效解决线性代数计算问题的函数库，最早就是用FORTRAN写成的。基于LINPACK发展起了Matlab——“Matrix Laboratory”(“矩阵实验室”)，它在理工科的地位相当程度上来源于它高效进行矩阵计算的能力。直到今天，测试新建的超级计算机，用的还是LINPACK的后裔LAPACK——超级计算机的性能是以解决线性代数问题的能力衡量的。

在强调“computer literacy”的当代，多数高校（特别是西方高校）的数统理工类专业，都会在本科低年级尽早开设计算机程序设计的必修课，讲授一门常用语言（Python最多，其次是Java、Matlab、R语言、C/C++等）的基础语法常识，并进行初步的编写调试程序的训练。由上可见，编程基础课跟《线性代数入门》*简直是绝配*：后者为前者提供了丰富而有实际意义的练习素材，而这些练习反过来又有助于深刻理解后者的相关知识点。而且两门课经常是同一学期开设的，非常适合于相辅相成地学习。

遗憾的是，从我读书时学习这两门课，到走上讲台十二年来观摩了这么多不同高校的数统理工类专业的课程设置和教学情况，还极少见过把这两门课结合在一起来讲的。很多高校会在高年级开设专门的《计算线性代数》，或者在《数值方法》这类课程中涉及线性代数的知识，但通常不会在大一的《线性代数入门》课上安排编程的作业。反过来，编程基础课上讲到数组、列表、矢量等数据结构时，也很少安排学生用这些解决稍复杂的线性代数问题。

当然，任何一种在科学计算上稍有应用的程序设计语言，都有现成的数值线性代数的函数库，包括但远不限于《线性代数入门》课上教的一切计算。除上述的LINPACK/LAPACK有FORTRAN和C的版本外，还有 Python 的 Numpy，Java 的 Jblas、la4j 等等，而 Matlab 和 Julia 更是自带这样的库。实际应用中，只需正确调用它们就好了，没有必要“重新发明轮子”地自己编写，但无脑调用这些库，让电脑帮忙写作业，对初学者深入理解这些计算的原理和用途毫无好处。虽然它们中不少是开源的，有点耐心就可以找到每个功能的源代码，但这些库通常是针对工业和科研上的实际应用设计的，为了提高运行效率而使用了较为高级的数值方法理念和编程技巧。让正在学习基本算法的大一初学者来研读这样的代码，很容易就会眼花缭乱一头雾水。

本项目的初衷是填补这一空白：将《线性代数入门》课上的一些主要知识点用简洁清晰的代码表现出来。一方面，与课内的理论知识和伪代码描述相互印证，更深刻地理解算法流程和计算中要留意的陷阱；另一方面，如果有哪位老师希望给学生布置一点编程的作业，或者有哪位同学想通过编程的方式巩固一下课上所学，但不知有哪些任务可以完成，不知怎么把每堂课后东鳞西爪写的代码模块组织起来，本项目的架构和设计可以提供一点参考。

## 项目内容

作为本科课程，哪怕名字相同，各校各专业的教学大纲、每位数学教授对内容取舍也肯定有不同。但笔者认为：一门分量合格的理工科大一《线性代数入门》课，总要包含下列知识点：

* 向量的加减、数乘、点乘（内积）、外积与叉乘、模（长度）与夹角
* 多个向量的线性组合
* 矩阵的加减、数乘；矩阵之间的乘法；矩阵的转置
* 将向量看成行矩阵或列矩阵，并据此理解向量的内积、外积，以及矩阵与向量的乘法
* 线性方程组的解法，解的个数的三种情况
* 将线性方程组写成 Ax = b 的形式，并通过对增广矩阵实施初等行变换消元求解方程组
* “行阶梯阵”和“约化行阶梯阵”的概念；用高斯消元法和高斯-若尔当消元法把任何矩阵化成这些形式，并藉此解方程组
* 方阵的逆的定义；消元法求可逆矩阵的逆
* 矩阵的秩，从任何矩阵对应的行阶梯阵看出原矩阵的秩，从系数阵和增广矩阵的秩判断方程组的解的情况
* 向量的线性相关性；从矩阵的行/列满秩情况判断其行/列向量的集合的线性相关性
* 一组向量张开的向量空间；向量空间的基与维数
* 矩阵的行空间、列空间、（行）零空间；“秩-零化度定理”
* 对具有无穷解的线性方程组，通过系数阵的零空间写出通解
* 行列式；行列式根据定义的计算及通过化成行阶梯阵的计算；用行列式求逆的办法
* 方阵的LU分解、方阵的PLDU分解；以及它们在解方程组、求行列式和求逆上的应用
* 向量与向量、矩阵与矩阵、向量空间与向量空间的正交性，正交矩阵及其判别
* 向量在指定向量空间上的投影的计算方法，及其在最小二乘法拟合上的应用
* 用格拉姆-施密特算法将一个向量空间的张成集化为该向量空间的一组正交归一基
* 矩阵的QR分解及其在解线性方程组、求特征值等场合的应用

当然，还有一些其它知识点是《线性代数入门》课应当包含的，以上列举的仅仅是比较容易用数值方法编程实现的内容。本项目的主要目标，正是将包括但不限于上述的知识点翻译成代码。

## 项目理念

1. **“能编译通过的伪代码”**：以讲解演示算法为目标，因此强调可读性，使用意义明确的标识符，避免一个语句执行多个计算步骤，不吝惜注释的笔墨，等等。
2. 考虑到我的很多学生是留学生，代码注释用全英文写成，免得有同学不认识中文的术语。以后考虑加一套中文版注释。
3. 代码执行效率的优先级**低于**可读性。这些代码的用途是教学演示而不是实际科研里的大规模计算。等学生彻底吃透了算法后，自然可以追求优化，或者调用现成的package/library。
4. 代码的稳定性的优先级**低于**可读性。在浮点数运算中尽量减少舍入截断误差的影响，这是《数值算法》或《计算线性代数》中的重要问题，本身就值得新开一个代码示范项目；而“病态”（条件数巨大）的矩阵的混沌性质，直到今天还是前沿课题。但在本科一年级，只要能把毫不病态的矩阵给算明白了，就是胜利。
5. 敦促读者养成正确的编程习惯和代码书写习惯并不是本项目的核心任务，但在代码风格上仍然大致遵循了[Google Styles Guides](https://google.github.io/styleguide/)的相关要求，例外是：有些标识符的命名按照数学上的习惯用单字母。为了简洁，本项目**并未很严格地遵循OOP的范式**，有兴趣的同学可以把它改写得更OOP一些。
6. 鉴于当代的《线性代数入门》课越来越普遍地掺入一些基本的优化技巧，比如消元时选用绝对值最大的主元(pivot)，这些在本项目的代码中也有适当演示。
7. 尽量不用各种语言的高级语法特性。比如Java的代码，只要具备AP Computer Science A 水平的语法知识就完全可以看懂。
8. 有些任务（如特征值的计算），虽然也是《线性代数入门》课上必讲的，但一般的讲法不适合于用数值方法实现，而常用的数值算法又通常不会在课内讲授。为了让学生可以体验一下，本项目仍然用数值算法实现了一些这样的任务。学生可以借助课内的知识尝试理解为什么这些方法行得通。

## 使用说明

1.  clone到自己的电脑上即可阅读。
2.  有些名词术语可能和您的课上用的不一致，可以相应调节代码注释。
3.  致教师：可以安排学生阅读和理解这些代码（欢迎按自己的风格和理解调整代码特别是注释），但更可以删除某些方法的具体实现的代码，布置作业让学生亲手写代码实现相应功能。
4.  致学生：重写本项目中的代码不需要太高级的计算机知识，但如果对数学课上的知识理解不深，想要把程序写对，写得能应付普遍情况，也不是容易的事。比如，你的代码也许对非奇异阵有效，但面对奇异矩阵呢？面对行列都不满秩的矩阵呢？建议先不要看我写的代码，按自己的理解写，然后借助项目自带的测试函数调试。

## 版本与计划

**v1.0** Java部分基本完成了

### 下版计划：
- [ ] 优先加入Python版本，然后有空可以加上C语言、R语言和Matlab的版本
- [ ] 把测试文件改写得系统一些
- [ ] 进一步完善Householder法的代码和QR法求特征值的代码
- [ ] 考虑加入的内容：SVD、二次型、Jordan标准型、矩阵的范数和条件数

如果走过路过的朋友觉得还有什么应该添加或更改的，<font color="red">**send me a pull request!**</font>

## 鸣谢

1. 恩师：感谢中山大学工学院的包芸教授，承担了我大一的《线性代数》和大三的《计算方法》两门课，培养了我对线性代数一生的兴趣。
2. 门生：感谢University of Ottawa的杨清昀同学，在师从我学习《线性代数入门》课期间完成了我布置的各项编程作业，形成了这个项目的雏形。感谢Imperial College of London的李承家同学在修习《计算线性代数》课时跟我的大量讨论，让我也学到了很多。感谢The University of Sherffield 的某位同学，给了我平生第一次从头到尾讲一套线性代数课的机会。
3. 参考教材：本项目主要参考的教材是 **Gilbert Strang** 的 *Introduction to Linear Algebra, 5th edition*，此外部分参考了UTM中 **Serge Lang** 的 *Introduction to Linear Algebra, 2nd edition* 和 **Vera Faddeeva** 的 *Computational Methods of Linear Algebra*.  我18岁时读的第一本有关教材是 **Steven Leon** 的 *Linear Algebra with Applications, 5th edition*，给我留下了正确的第一印象。
